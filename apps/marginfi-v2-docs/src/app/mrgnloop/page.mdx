import { ImageComponent } from '~/components/ImageComponent'

import MobileSigninCrypto from '~/images/docs/mobile-signin-crypto.png'
import Looper1 from '~/images/docs/looper-1.png'
import Looper2 from '~/images/docs/looper-2.png'
import Looper3 from '~/images/docs/looper-3.png'
import Looper4 from '~/images/docs/looper-4.png'
import Looper5 from '~/images/docs/looper-5.png'
import Looper6 from '~/images/docs/looper-6.png'

export const metadata = {
  title: 'mrgnloop User Guide',
  description: 'A User Guide to Arbitraging Interest Rates',
}

# mrgnloop: A User Guide to Trading with Leverage

Use mrgnloop to arbitrage interest rates across a diverse range of assets and open leveraged long positions with marginfi flashloans. {{ className: 'lead' }}

---

## How Does mrgnloop Work? {{ tag: '', label: '' }}

mrgnloop uses marginfi flashloans to make accessing leverage more user friendly than ever. This is because marginfi-v2 flashloans allow Looper to bundle multiple borrow and lend instructions within a single transaction. Flashloans allow marginfi accounts to borrow an outsized position relative to their lend position by circumventing the health checks that are typically performed when a user withdraws liquidity from marginfi.

For example, if a user wanted to open a long position on SOL relative to USDC, marginfi flashloans would handle the process in the follwing order:
1. The flashloan first borrows all the USDC the user needs.
2. The flaslohloan swaps the USDC for SOL.
3. The flashloan deposit the SOL from the swap and the principal lent amount into the user's marginfi account. At this point, the flashloan has ended.
4. The health check is performed once the flashloan has completed. 

Flashloans allow the user to be in bad health during the borrow-lend process without throwing an error, as long as the user is in good health at the end of the transaction. 

<Note>
    When you have a starting amount to deposit, like 10 SOL, and decide which tokens you want to borrow against and their respective weights, this will determine your Loan-to-Value (LTV) ratio and maximum leverage. LTV is the ratio of your loan amount to the value of your deposited assets. With this information, you can calculate how much you can increase your investment through leverage.
</Note>

By using flashloans, mrgnloop ensures that users can access liquidity without the typical constraints of traditional borrowing and lending processes. With mrgnloop, you can maximize your capital efficiency by leveraging their assets, meaning **you can control larger positions with a smaller initial investment**. 

mrgnloop uses flashloans to create a secure and flexible method for optimizing capital and **enabling long strategies**, all within a secure and user-friendly platform.

---

## Gettting Started with mrgnloop {{ tag: '', label: '' }}

**Step 1**. Go to the <Button href="https://app.marginfi.com/" variant="text"><>marginfi app</></Button> and connect your Solana wallet:

<ImageComponent
  src={MobileSigninCrypto}
  isBig={false}
  alt="mrgnloop photo"
/>

**Step 2**. Navigate to the <Button href="https://app.marginfi.com/looper" variant="text"><>mrgnloop page</></Button> in the navigation menu:

<ImageComponent
  src={Looper1}
  alt="mrgnloop photo"
/>

**Step 3**. Open a long position on a token of your choice by clicking the "Select token" dropdown under "You deposit" in the Action Box:

<ImageComponent
  src={Looper2}
  alt="mrgnloop photo"
/>

**Step 4**. Before specifying how much you want to deposit, click the "Select token" dropdown under "You borrow" in the Action Box:

<ImageComponent
  src={Looper3}
  alt="mrgnloop photo"
/>

**Step 5**. Proceed to enter the amount you want to deposit:

<ImageComponent
  src={Looper4}
  alt="mrgnloop photo"
/>

**Step 5**. Finally, dial in how much leverage you want to take on your position using the slider:

<ImageComponent
  src={Looper5}
  alt="mrgnloop photo"
/>

<Note>
    As you dial in how much leverage you want to take on, your account health and other relevant metrics will adjust in real-time. Note that the flashloan will transaction will only execute if your account health is in good standing by the end of the transaction.
</Note>

<ImageComponent
  src={Looper6}
  alt="mrgnloop photo"
/>

---

## Conlcusion

This user guide has outlined the fundamental aspects of leveraged borrowing and lending with mrgnloop. By understanding and utilizing the features of mrgnloop, you can effectively optimize and leverage your capital, while also mitigating risks through overcollateralization and robust risk management strategies. Embrace the future of DeFi with mrgnloop and explore the endless possibilities that decentralized borrowing and lending have to offer.

Stay in touch with marginfiâ€™s latest news by following us on <Button href="https://x.com/marginfi" variant="text"><>X</></Button>, and get in touch with the team via our <Button href="https://discord.com/invite/mrgn" variant="text"><>Discord</></Button>. See you in the arena!
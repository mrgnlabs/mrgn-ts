import { ImageComponent } from '~/components/ImageComponent'

import CreateBankExample from '~/images/docs/create-bank-example.png'
import SupplyExample from '~/images/docs/supply-example.png'
import TradeExample from '~/images/docs/trade-example.png'
import PortfolioExample from '~/images/docs/portfolio-example.png'

export const metadata = {
  title: 'The Arena User Guide',
  description: 'The Arena is a permisionless lending market that allows users to long and short any token on Solana',
}

# The Arena: A User Guide to Degeneracy

For the first time on Solana, take leveraged long and short positions on any asset (e.g., memecoins, celebrity coins, major market cap tokens) and permissionlessly create your own isolated banks for any token, using any collateral. {{ className: 'lead' }}

---

## Permissionless Banks {{ tag: '', label: '' }}

Historically, the creation of isolated banks has been controlled by the marginfi team. marginfi has utilized isolated banks to allow users to borrow and lend certain assets without their liquidity and borrow-lend activity affecting the main liquidity pool - hance the term "isolated."

However, with The Arena, the marginfi team is opening up the ability to create isolated groups to everyone. Now, **you can permissionlessly create isolated banks for any token you want, using any collateral you want** directly through <Button href="https://www.thearena.trade/" variant="text"><>The Arena app</></Button>, the marginfi CLI, or the marginfi TS SDK.  Because permissionless banks are isolated banks, **the trading activity that occurs within any given permissionless bank does not impact marginfi's main liquidity pool**. 

<Note>
  This article is not an advertisement of any token, nor a soliciation to purchase or conduct financial activity with any token. This article is purely for educational purposes.
</Note>

Are you a fan of Iggy Azalea? Permissionlessly create a bank for $MOTHER and open a max-leveraged long position. When you decide you're tired of her music, open a short position. Share the bank you created with others; invite them to make trades with you. You're in the driver's seat.

**For every token listed on The Arena, an isolated group will be created to hold the token bank (e.g., $BODEN) and the collateral bank (e.g., $USDC)**. The creator of the bank will be assigned as admin over this group.

<ImageComponent
  src={CreateBankExample}
  alt="photo"
/>

You can think of a group as a collection of banks and accounts that are governed together. The admin of the group has the authority to perform various administrative actions such as enabling or disabling flash loans, managing account transfer authority, and configuring bank parameters. This structure ensures that **each permissionless bank operates within its own isolated environment, unassociated with the main marginfi liquidity pool**.

<Note>
    User funds cannot be withdrawn from a bank by the group admin. All banks listed on The Arena are vetted by the marginfi team. Bank creation is permissionless, so always be sure to do your own research on pool creators and oracles.
</Note>

All token banks listed on The Arena are isolated and completely separate from those on mrgnlend. Banks need liquidity to enable trading. You can provide liquidity for an APY for both token and $USDC banks on a given bank's page. Select "View" on a bank card to get started.

---

## Leveraged Trading for Any Asset {{ tag: '', label: '' }}

Longtail assets, which are less popular and less traded, often suffer from low liquidity. This makes it difficult to execute large trades without significantly impacting the asset's price. Low liquidity also increases the risk of slippage, where the trade executes at a different price than expected.

By using the marginfi Liquidity Layer, The Arena opens up new opportunities for traders to explore and profit from a wider range of assets without the traditional limitations and risks associated with low liquidity.

<ImageComponent
  src={TradeExample}
  alt="photo"
/>

<Note>
    Charts powered by <Button href="https://www.tradingview.com/" variant="text" title="Where the world follows the bitcoin chart.">TradingView</Button>.
</Note>

Leveraged trades are made possible with marginfi flashloans. marginfi-v2 flashloans bundle multiple borrow and lend instructions within a single transaction, circumventing the routine health-check that executes when you withdraw liquidity from marginfi. **The Arena uses flashloans to create a secure and flexible method for optimizing capital and enabling long and short strategies**.

Per usual, if a given position falls below the liquidation threshold, the position will be at risk of liquidation. Review the <Button href="https://docs.marginfi.com/introduction#account-health" variant="text"><>Account Health documentation</></Button> to learn more about liquidation risk on marginfi.

<Note>
    To learn more about marginfi-v2 flashloans, reference the flashloan endpoints in the <Button href="http://docs.marginfi.com/mfi-v2#instructions" variant="text"><>marginfi-v2 instructions</></Button> documentation.
</Note>

For the time being, all token banks on The Arena are paired with $USDC. Deposit a given bank's token to go long and leverage against $USDC. Deposit $USDC to go short and leverage against the bank's token. **Soon you will be able to create token pairs of any kind**.

**Taking a long or short position involves borrowing and lending different assets depending on the desired trade direction**. For example, if you want to open a long position for $BODEN, your goal is to profit from an increase in $BODEN's price relative to $USDC. To do this, you would borrow $USDC and use it to purchase more of $BODEN. As the price of $BODEN goes up, you can close your position and repay your loan in $USDC, keeping the remains as profit.

Conversely, if you believe the price of $BODEN will decrease, you can profit from this negative price movement by borrowing $BODEN and swapping it for $USDC. When $BODEN's price drops, you can buy it back at a lower price to repay the debt, keeping the difference as profit.

<Note>
  The Arena is not limited to trading longtail assets. **You can trade any coin**. LSTs, large market cap tokens, memecoins, celebrity tokens, etc.
</Note>

---

## Supply Liquidity & Earn Yield {{ tag: '', label: '' }}

Using $BODEN as an example, you cannot leverage long $BODEN while also lending $USDC in the $BODEN bank. Likewise, you cannot leverage short $BODEN while also lending $BODEN in the $BODEN bank. (This goes for all token banks on The Arena.)

This is because when you take a leveraged position, you are essentially borrowing the asset you're betting against. If you were simultaneously lending that same asset, it would create a conflict in the system and negate the purpose of the leveraged trade.

Let's step through this:

* When you go long on $BODEN, you're borrowing $USDC to buy more $BODEN. You can't lend $USDC at the same time because that $USDC is being used to create your leveraged position.
* When you go short on $BODEN, you're borrowing $BODEN to sell for $USDC. You can't lend $BODEN at the same time because that $BODEN is being used to create your leveraged short position.

<ImageComponent
  src={SupplyExample}
  alt="photo"
/>

However, you can earn attractive yields by lending either $BODEN or $USDC into the token bank. Using the $BODEN bank as an example:

* When the trading trend for $BODEN is predominantly short, the APY for lending $BODEN increases.
* When the trading trend for $BODEN is predominantly long, the APY for lending $USDC increases.

<Note>
  Lending and borrowing into a similar token bank on <Button href="https://app.marginfi.com/" variant="text"><>mrgnlend</></Button> will not affect the positions you have on a similar token bank on The Arena. **All banks on The Arena are completely isolated from those on mrgnlend**.
</Note>

These fluctuating lending rates create opportunities for users to maximize yield by arbitraging between the two assets and providing liquidity for both trade directions.

As a lender on The Arena, you assume the same liquidation risk as when lending on <Button href="https://app.marginfi.com/" variant="text"><>mrgnlend</></Button>. Specifically, this means you risk liquidation if your <Button href="https://docs.marginfi.com/introduction#account-health" variant="text"><>account health</></Button> falls below the liquidation threshold.

<ImageComponent
  src={PortfolioExample}
  alt="photo"
/>

Remember, each bank you lend into is completely isolated, meaning you have a separate local health factor for every bank. You can view your health factor for each of your positions by clicking on the corresponding LP position listed on the <Button href="https://www.thearena.trade/portfolio" variant="text"><>Portfolio page</></Button>.

---

## Integrate with Our Infrastructure {{ tag: '', label: '' }}

We built The Arena on top of our flashloan and isolated bank infrastructure to showcase the innovative use cases made possible by marginfi's Liquidity Layer. The infrastructure for accessing leverage and creating permissionless banks is double-audited and ready-for-production. **Anyone can access and build on marginfi's leveraging and permissionless bank infrastructure**, and many teams already do. 

The Arena application is <Button href="https://github.com/mrgnlabs/mrgn-ts/tree/feature/arrakeen/apps/marginfi-v2-trading" variant="text"><>fully open-sourced</></Button>. If you're a developer, feel free to review <Button href="https://github.com/mrgnlabs/mrgn-ts/blob/91834b3210e2748a4a036386a8d0afb3096cad66/apps/marginfi-v2-trading/src/components/common/TradingBox/tradingBox.utils.tsx" variant="text"><>the code for making leveraged trades</></Button> and implement marginfi's leveraging infrastructure in your own apps today!

* **Memecoin Prediction Markets:** Create a platform where users can bet on the success of memes and profit on the outcome of events.
* **Leveraged Swap Interfaces:** Create a swap interface that allows users to make leveraged trades directly within the application.
* **Create a Borrow-and-Lending Market:** Create a borrow-and-lending market for a specific asset class using permissionless banks.

These are just a few examples of what you can build using the marginfi Liquidity Layer and our new trading infrastructure. The possibilities are endless.

<Note>
    Click <Button href="http://docs.marginfi.com/rust-sdk#examples" variant="text"><>this link</></Button> to reference examples of how to create permissionless banks using the marginfi CLI. Click <Button href="http://docs.marginfi.com/ts-sdk#examples" variant="text"><>this link</></Button> to view examples using the TS SDK.
</Note>

marginfi is enthusiastic about opening our infrastructure to all teams looking to push the limits of Solana DeFi, and **we are opening a grants program to help you build on our Liquidity Layer**. For more information on this grants program and for integration assistance, **please get in touch with @nathanzebedee on Telegram**.

---

## Enter The Arena {{ tag: '', label: '' }}

This guide has shown you how to use The Arena’s features to take advantage of marginfi's Liquidity Layer and flashloan capabilities, opening up new trading opportunities with longtail assets. Stay in touch with marginfi’s latest news by following us on <Button href="https://x.com/marginfi" variant="text"><>X</></Button>, and get in touch with the team via our <Button href="https://discord.gg/pJ3U7gHJFe" variant="text"><>Discord</></Button>. See you in The Arena!

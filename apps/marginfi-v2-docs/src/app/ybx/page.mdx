import { ImageComponent } from '~/components/ImageComponent'
import { Math } from '~/components/Math'

import Formula1 from '~/images/docs/ybx/formula1.png'
import Formula2 from '~/images/docs/ybx/formula2.png'
import Formula3 from '~/images/docs/ybx/formula3.png'

export const metadata = {
  title: '$YBX White Paper',
  description:
    'On this page, we’ll learn about $YBX: A stable asset to capture blockchain monetary policy.',
}

# The $YBX White Paper

$YBX is a decentralized stable asset soft-pegged to the $USD that accrues its holders blockchain staking yield, so that they can naturally capture base layer monetary policy and protect themselves from blockchain-based inflation risk. {{ className: 'lead' }}

<Note>
    The $YBX product is double-audited and production-ready. However, the marginfi team has decided to postpone the launch of $YBX until certain Solana scalability issues are solved. 
    marginfi has put a lot of consideration into this decision, and we are working diligently to improve core Solana infrastructure to make $YBX a reality for all Solana DeFi users.
</Note>

---

## Introduction {{ tag: '', label: '' }}

With roughly half a billion US dollars in value deposited on the mrgnlend platform, mrgnlend has enabled depositors to earn competitive yields on a diverse range of collateral types, from stablecoins to memetic/social tokens, and enabled traders to borrow these assets for both short-term and long- term market strategies. As a significant entity in Solana’s DeFi ecosystem, mrgnlend’s innovative risk management and liquidation mechanisms are paramount to ensuring the platform remains a resilient and reliable borrow/lend primitive within the ecosystem. With mrgn’s $LST product seeing wide adoption as the liquid staking solution with the highest yield, we aim to build upon these primitives and pioneer the first instrument offering stable exposure to L1 emissions on Solana.

### The Rise of Liquid Staking Tokens (LSTs)

Solana’s Liquid Staking Token (LST) landscape has, in many ways, leapfrogged its counterparts in Ethereum. Solana boasts a streamlined Stakepool program that all LSTs utilize, benefiting from a 7x audited, trusted core piece of enshrined code. Sanctum, a newer development on Solana, has effectively made all LST liquidity completely fungible, thereby strengthening the utility and liquidity of LSTs and enabling them to become critical components of DeFi. The LST space itself has evolved on Solana, initially moving from liquid-staked SOL—similar to what is observed on Ethereum—to more customized LST solutions.

Marinade emerged as the first major player, providing a service akin to that found on Ethereum. Marinade delegates to a wide array of validators to aid in network decentralization. Stakers recieve mSOL and receive an average yield, given the variable commission that delegated validators run. There are also additional fees at the LST layer. Subsequently, Jito entered the scene, staking to a broad range of validators, similar to Marinade, but exclusively staked to validators running the Jito-Solana client. This means Jito only delegates to validators that also earn any MEV rewards explicitly from Jito’s auctions.

Then, $LST emerged, deciding to stake solely to MRGN validators running zero commission. $LST incurs no fees, and MRGN validators also run the Jito-Solana client, earning MEV rewards. Apart from the impact commission has on yield, validators also have variable performance earning vote credits (inflation rewards). MRGN validators are among the best-performing in the ecosystem, securing a maximum number of vote credits and earning a best-in-class yield.

### The Evolution of Stable Digital Assets

A long-standing effort to mitigate on-chain users’ exposure to the volatility of incumbent digital assets, stable digital assets have undergone significant evolution since their inception. The class of stable digital assets first emerged with the invention of stablecoins, with MakerDAO notably creating $DAI, a pioneering project that introduced the idea of cryptocurrency with a stable value pegged to traditional fiat currencies. This innovation laid the groundwork for the stablecoin market, balancing the volatility of cryptocurrencies with the stability of fiat. $DAI continues to operate as a stablecoin backed fully by other on-chain digital assets, and implements a collateralized debt position mechanism that allows $DAI to be backed by more collateral than its worth, ensuring its value.

As the market matured, fiat-collateralized stablecoins like $USDT and $USDC saw their rise, offering straightforward, fiat-backed stability. This phase marked a significant leap in user trust and adoption, bridging the gap between traditional and digital finance, but brought back certain centralization risks from off-chain technological infrastructure that collided with the ethos of de- centralization.

Stablecoins are a good way to mitigate portfolio delta exposure relative to more mature sovereign currency pegs, but they have a stark weakness that’s shared by sovereign currencies around the world: **exposure to inflation**.

In traditional finance, assets like US Treasury bonds have long existed to provide (in the case of US Treasury bonds specifically, $USD holders) a way to:
1. Hold exposure in the stable US Dollar
2. Protect themselves from inflation through US Treasury bond yield

High-yield bank accounts available to the general US public have had similar use cases.

In the digital asset realm, protocols like Maker and Frax Finance have looked to provide on- chain stable asset holders similar protection from (in this case) US inflation, with Real World Assets (RWAs) integrating into on-chain protocol systems to provide holders with direct exposure to sovereign treasury bonds and alike. However, blockchain economies deal with an inflation vector that is more present, higher risk, and easier to protect against than sovereign currency inflation: **native blockchain token inflation**.

LSTs are already a case study for this: relative to holding native $SOL, which continues to increase in supply under Solana’s inflationary monetary policy, $SOL-based LSTs provide users with exposure to naturally accruing inflationary blockchain yield, so that users are protected from the blockchain inflation risk they’d otherwise be exposed to if holding $SOL. At hundreds of basis points for the foreseeable future, native blockchain yield continues to be important for holders to capture. While helpful, LSTs continue to expose users to SOL-based delta exposure relative to $USD - pegged to $SOL, LSTs are not stable assets. Historically, holders have been forced to choose between protecting against:
* Inflationary risk by capturing staking yield with LSTs, or
* Token price volatility with traditional stablecoins

<Note>
    $YBX is a stable asset soft-pegged to the $USD that accrues its holders blockchain staking yield, so that they can naturally capture base layer monetary policy and protect themselves from blockchain-based inflation risk.
</Note>

### $YBX: An Evolved, Soft-Pegged Asset Solving for Yield and Stability

$YBX is a stability solution that allows holders to capture yield from native monetary policy imple- mented by blockchain base layers without having delta exposure to the underlying blockchain tokens; it’s presented as the first way to hold stable exposure that is resilient to underlying blockchain in- flation.

Expanded upon below, it’s worth noting that $YBX is a non-rebasing, yield-bearing stable asset. This means that while $YBX has a soft peg to the USD, **the value of $YBX will intentionally diverge over time from the USD to reflect accrued blockchain yield**.

---

## Minting and Yield Mechanism {{ tag: '', label: '' }}

### Support Collateral

$YBX is an overcollateralized asset, meaning it is backed by more value in collateral than the amount of $YBX issued. This collateralization is crucial for maintaining stability and trust in the $YBX system. The minting process for $YBX involves the use of Solana-based Liquid Staking Tokens (LSTs) as collateral. To start, the following Solana LSTs are accepted:
* $LST
* $jitoSOL
* $mSOL
* $bSOL

Over time, support for additional LSTs with adequate liquidity should be considered.

When minting $YBX, an asset weight, denoted as wa, is applied to the collateral. This weight effectively discounts the value of the collateral, accounting for potential volatility and liquidity risks. The concept of asset weighting is standard in lending protocols and is critical for managing risk and maintaining the system’s integrity.

### Cost to Minters and Yield to Holders

The process of minting $YBX is akin to entering a borrowing agreement on a lending platform, where the borrower incurs an interest cost over the time they hold the borrowed funds. This analogy is pertinent in understanding that the cost incurred by minters of $YBX is effectively covered by the yield generated from the LSTs used as collateral. Because both the LST collateral and $YBX is non-rebasing, minters pay the $YBX borrowing cost by having some of their LST collateral sold for $YBX bought from the market by the protocol. The purchased $YBX, in turn, is burned by the protocol, thereby decreasing $YBX supply and increasing its inherent value.

Consider a scenario where a SOL-based LST yields an 8% annual return. With the spot price of SOL denoted as PSOL, the adjusted value of the LST including yield would be PLST = PSOL × (1 + 0.08). For minting $YBX, aimed to be pegged around $1, an equivalent interest rate reflecting the LST yield is applied, effectively translating the LST yield into a cost for the minter. This mechanism is described by the formula:

<ImageComponent
  src={Formula1}
  width={700}
  height={700}
  alt="Formula"
/>

Given that P$YBX is approximately 1, we find:

<ImageComponent
  src={Formula2}
  width={700}
  height={700}
  alt="Formula"
/>

This formula demonstrates that the effective interest rate for minting $YBX is proportionate to the yield of the SOL-based LST and its market value. It emphasizes that the yield forfeited by the minter—through a reduction in the native LST tokens held as collateral—is captured and distributed to $YBX holders. This yield is managed within the $YBX vault and, when the marginal LST collateral is sold, the proceeds are used to purchase $YBX from the market. This strategy ensures that the yield generated from the collateral directly benefits $YBX holders, reinforcing the symbiotic relationship between the cost of minting and the reward to holders.

By selling the collateral yield for $YBX tokens which are then burned, the platform ensures a transparent and efficient mechanism for distributing yield to holders, aligning the interests of both minters and holders within the ecosystem. This approach not only stabilizes the $YBX value but also fosters a robust ecosystem where the benefits of collateral yield are equitably shared among participants.

---

## Stability Mechanism {{ tag: '', label: '' }}

A fundamental aspect of $YBX’s design is its stability mechanism, which ensures its peg to the USD while recognizing its unique characteristics as a non-rebasing, yield-bearing asset. This mechanism comprises several components, ranging from conventional features seen in stablecoins to innovative approaches aimed at elevating the standard for stable asset performance.

### Arbitrage Resolution

The $YBX protocol includes mechanisms for minting $YBX by depositing collateral and redeeming collateral by burning $YBX, similar to stablecoin implementations. This minting and burning process is nominally pegged at 1 $YBX to (1+Y) $USD, where Y is the divergence from accumulated yield, enabling arbitrage opportunities when the market price of $YBX diverges from the $(1+Y) USD benchmark:
* **If 1 $YBX > (1 + Y) $USD**: Arbitrageurs can mint new $YBX by depositing collateral into the $YBX smart contract and selling the minted $YBX on the open market. This action increases the supply of $YBX, applying downward pressure on its price to realign it with the peg.
* **If 1 $YBX < (1 + Y) $USD**: In this scenario, arbitrageurs can purchase $YBX below its nominal value and redeem it at (1 + Y ) $USD worth of collateral from the $YBX smart contract, thereby reducing the circulating supply of $YBX and pushing its market price back toward the peg.

### Liquidation of Weakening Collateral

The $YBX ecosystem operates on an overcollateralized basis, incorporating a liquidation protocol akin to those found in permissionless lending systems. This protocol is triggered under specific conditions, primarily when the value of the collateral backing $YBX loans depreciates beyond a critical threshold. The liquidation criterion is determined by the following equation:

<ImageComponent
  src={Formula3}
  width={700}
  height={700}
  alt="Formula"
/>

where:
* <Math>pliq</Math> is the liquidation threshold price per token, e.g 1.15.
* <Math>qi</Math> is the quantity of the ith collateral asset.
* <Math>pi(t)</Math> is the market price of the ith asset at time t.
* <Math>wi</Math> represents the weight of the ith asset in the collateral basket.
* <Math>n</Math> is the total number of collateral assets.
* <Math>L</Math> is the total value of $YBX minted against the collateral, according to the internal peg.

Upon triggering the liquidation process, the collateral is sold, and $YBX is bought back from the market and subsequently burned. This action directly reduces the circulating supply of $YBX, aiding in the re-establishment of its value relative to the USD.

Importantly, as a yield-bearing asset, $YBX is designed to appreciate over time, akin to how LSTs accrue value relative to SOL. Consequently, $YBX’s value is expected to gradually increase in comparison to the USD, reflecting the accumulated yield. This design distinguishes $YBX from stablecoins by embedding yield generation directly into its value proposition, offering users a stable asset that not only preserves value but also appreciates relative to the $USD over time.

Dynamic collateral management is pivotal in maintaining the solvency and stability of the $YBX ecosystem. By allowing users to adjust their collateral contributions in response to market movements, the system enhances individual and collective resilience to volatility, underscoring the adaptive and proactive nature of $YBX’s stability mechanism.

### Last-Resort Bad Debt Backstops

The aforementioned stability mechanisms are robust, but it’s worth considering scenarios in which they fail for maximum mechanism resiliency. In the event of bad debt or insolvency within the $YBX ecosystem that is not mitigated preemptively by the above stability mechanisms, there is an opportunity for a mechanism akin to MakerDAO’s $MKR token backstop; a governance and utility token for the $YBX protocol that is minted and sold into the market to ensure the solvency of the $YBX stable asset and protect its soft peg to the $USD under the most adverse conditions.
* **Mechanism Activation**: Should the $YBX protocol face a shortfall in collateral value due to market downturns or unexpected liquidations, resulting in bad debt that cannot be covered by the existing collateral, the protocol may activate an emergency response mechanism.
* **Minting the protocol governance token**: To address the insolvency, additional gover- nance tokens are minted and sold on the open market. The proceeds from this sale are used to cover the bad debt, thereby restoring the collateral balance and ensuring the stability and integrity of $YBX.
* **Market Dynamics**: The introduction of new protocol governance tokens to the market may impact the token’s price due to the increase in supply. However, this action is considered a last resort and is taken to safeguard the $YBX ecosystem and its users.
* **Governance and Transparency**: The decision to mint and sell protocol governance tokens would most properly be governed by a DAO overseeing the $YBX protocol, ensuring that such measures are taken with transparency and align with the interests of the stakeholders. This governance process allows governance token holders to participate in critical decisions affecting the protocol’s financial health and stability.

This governance token intervention mechanism underscores the protocol’s resilience and adapt- ability, providing a robust safety net that enhances the trust and reliability of $YBX. By drawing inspiration from established protocols like MakerDAO, $YBX can leverage proven strategies to mitigate risk and maintain stability, demonstrating a commitment to the long-term viability and success of the ecosystem.